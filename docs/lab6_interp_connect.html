<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Phoebe Zarnetske; plz@msu.edu" />


<title>MSU Graduate Spatial Ecology Lab 6</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">MSU Grad Spatial Ecology</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="lab1_R.html">Lab 1</a>
</li>
<li>
  <a href="lab2_scale.html">Lab 2</a>
</li>
<li>
  <a href="lab3_patch_design.html">Lab 3</a>
</li>
<li>
  <a href="lab4_autocorrelation.html">Lab 4</a>
</li>
<li>
  <a href="lab5_variograms.html">Lab 5</a>
</li>
<li>
  <a href="lab6_interp_connect.html">Lab 6</a>
</li>
<li>
  <a href="lab7_opendata.html">Lab 7</a>
</li>
<li>
  <a href="lab8_sdm1.html">Lab 8</a>
</li>
<li>
  <a href="lab9_sdm2.html">Lab 9</a>
</li>
<li>
  <a href="lab10_sdm3.html">Lab 10</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">MSU Graduate Spatial Ecology Lab 6</h1>
<h4 class="author">Phoebe Zarnetske; <a href="mailto:plz@msu.edu" class="email">plz@msu.edu</a></h4>
<h4 class="date">Oct 6-7, 2020</h4>

</div>


<div id="lab-6-connectivity-interpolation" class="section level1">
<h1>Lab 6: Connectivity, Interpolation</h1>
<p>This lab covers connectivity analysis with the <code>grainscape</code> R package. I have also included some extra OPTIONAL exercises at the end of the lab on interpolation with the <code>gstat</code> R package.</p>
<p>For the connectivity analysis, you need to hand in a PDF produced from R Markdown (or if you have trouble knitting, you can copy and paste into a Word doc and save as PDF), including output plots, any statistics, code, and text for answers to the questions.</p>
<div id="connectivity-with-grainscape-r-package" class="section level2">
<h2>Connectivity with <code>grainscape</code> R package</h2>
<p>Landscape connectivity reflects how well patches on a landscape are connected. Applications in conservation biology include corridor analysis and resilience of networks of reserves. Landscape connectivity can tell us how difficult or easy it is to travel between patches across a landscape, depending on the organism or phenomena of interest. For a great example of some applications of Corridors for Conservation and examples of Corridor projects and landscape-scale experiments, check out: <a href="https://conservationcorridor.org/" class="uri">https://conservationcorridor.org/</a>, which is co-led by Nick Haddad, Professor at Michigan State University and Director, Kellogg Biological Station Long-Term Ecological Research (LTER).</p>
<center>
<img src="https://conservationcorridor.org/wp-content/uploads/conservation_corridor_logo_sm.png">
</center>
<center>
<img src="PL_Zarnetske_2010-03-15_63.jpg">
</center>
<p>Lake Tekapo and surrounding landscape, New Zealand. Phoebe L. Zarnetske 2010.</p>
<p>Connectivity analysis takes into account barriers to dispersal and movement for a given organism or phenomena of interest. These include natural barriers (e.g., terrestrial vs. aquatic systems, mountain ranges, certain land cover types) and manmade (e.g., dams, roads, developed land, conversion to agriculture).</p>
<p>To learn about how to quantify connectivity across a landscape, you will work through the <strong><a href="https://cran.r-project.org/web/packages/grainscape/vignettes/grainscape_vignette.pdf"><code>grainscape</code> vignette</a></strong>. Here is the <em><a href="https://github.com/achubaty/grainscape/blob/master/vignettes/grainscape_vignette.Rmd">RMarkdown version of the <code>grainscape</code> Connectivity Vignette</a></em></p>
<p>Work through the grainscape vignette at least through <em>Modeling with Grainscape</em> - you can continue on if you’d like (it is a long vignette). Read the first few pages of <em>Landscape networks with 1D and 2D nodes</em> to be able to answer one of the questions below. Turn in your work on the vignette to show how far you completed, plus the questions below. Even if you do not finish the entire vignette, answer all of the following questions:</p>
<div id="grainscape-question-1" class="section level3">
<h3><code>grainscape</code>: QUESTION 1</h3>
<p>Answer the following questions in a few sentences each: What is a minimum planar graph? What is a Voronoi tessellation? What is a 2D node and how does it compare with a 1D node?</p>
</div>
<div id="grainscape-question-2" class="section level3">
<h3><code>grainscape</code>: QUESTION 2</h3>
<p>How do the analyses presented in this vignette relate to analyses you would perform with patch metrics from the landscapemetrics R package or Fragstats (see Lab 3 Question 1 for links to definitions on patch metrics)? How are they similar and how are they different?</p>
</div>
<div id="grainscape-question-3" class="section level3">
<h3><code>grainscape</code>: QUESTION 3</h3>
<p>For a given species or phenomena moving across a landscape, how would you use ecological theory, and knowledge of the species natural history or phenomena, to assign resistance values and create a minimum planar graph? Use an example to explain your answer.</p>
</div>
<div id="grainscape-question-4" class="section level3">
<h3><code>grainscape</code>: QUESTION 4</h3>
<p>How does spatial scale of land cover or elevation data affect the interpretation of connectivity?</p>
</div>
</div>
<div id="optional-exercises-interpolation-with-gstat-r-package" class="section level2">
<h2>OPTIONAL EXERCISES: Interpolation with <code>gstat</code> R package</h2>
<p>If you would like more practice fitting variograms and applying a variogram fit to interpolate between points in a different R package to create a smooth surface, complete the <strong><a href="https://cran.r-project.org/web/packages/gstat/vignettes/gstat.pdf"><code>gstat</code> vignette</a></strong>. After completing the vignette with the meuse data, complete the vignette again to construct variograms and interpolate using a dataset of your choice with a continuous variable that is associated with geographic coordinates. If you don’t have a dataset of your own, you could use the Bryce Canyon species and site data from Lab 4 or the WEF data from Lab 5. For any dataset you choose, select just 1 response variable of interest (e.g., as is done with “zinc” with the meuse data).</p>
<p><em>Extra Resource:</em> You may also find this exercise helpful in explaining some additional aspects of interpolation: <a href="https://rspatial.org/raster/analysis/4-interpolation.html" class="uri">https://rspatial.org/raster/analysis/4-interpolation.html</a>. It uses the <code>gstat</code> package as well, but with precipitation data in California from the <code>rspatial</code> R package.</p>
<p>When working through the <strong><a href="https://cran.r-project.org/web/packages/gstat/vignettes/gstat.pdf"><code>gstat</code> vignette</a></strong> with the data you chose:</p>
<ol style="list-style-type: decimal">
<li><p>Fit 2 types of variograms. The example with the meuse data fits a Spherical and an Exponential model. See <code>?fit.variogram</code> and <code>?vgm</code> for options.</p></li>
<li><p>Use 2 grid resolutions to evaluate the influence of resolution on the interpolation. see below for the <code>cellsize()</code> option.</p></li>
<li><p>Consider the questions at the end of this section below.</p></li>
</ol>
<p>Below is some example code for starting to use bryceveg and brycesite with <code>gstat</code>. You could modify it for your own data or use it to start the <code>gstat</code> vignette with bryceveg and brycesite.</p>
<p><em>Start working in R:</em></p>
<pre class="r"><code>##### STARTING UP R
# Clear all existing data (or don&#39;t and just make sure you start with a newly opened RStudio session; see why this may not be so great for reproducibility: https://rstats.wtf/save-source.html#rm-list-ls)
rm(list=ls()) 

# Close graphics devices
graphics.off()

# Set the paths for your work
output_path&lt;-(&quot;output&quot;)
# if this folder doesn&#39;t exist, create it
if(!dir.exists(output_path)){
  dir.create(output_path)
}

# Create the folders (directories) &quot;data&quot; and &quot;lab6&quot; - If they exist already, this command won&#39;t over-write them.
data_path&lt;-(file.path(&quot;data&quot;,&quot;lab6&quot;))
if(!dir.exists(data_path)){
  dir.create(data_path,recursive = TRUE)
}</code></pre>
<p>If you previously saved your workspace and want to load it here, do so this way:</p>
<p><code>load(file.path(output_path,"lab6.RData"))</code></p>
<p><strong>NOTES on R packages used in this lab:</strong></p>
<ol style="list-style-type: decimal">
<li>With R Markdown, it is helpful to install packages locally before knitting (copy this into your R console before you knit). <code>for (package in c("gstat","sp","labdsv")) {</code> <code>if (!require(package, character.only=T, quietly=T)) {</code></li>
</ol>
<p><code>install.packages(package)</code></p>
<p><code>library(package, character.only=T)</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<p>Load the packages:</p>
<pre class="r"><code>library(gstat)
library(sp)
library(labdsv)</code></pre>
<p>Example code for starting with the bryceveg and brycesite data. Merge it into one dataframe, containing only points with valid coordinates.</p>
<pre class="r"><code>data(bryceveg)
data(brycesite)
veg&lt;-bryceveg
site&lt;-brycesite
# Calculate species richness by plot
spc.rich &lt;- apply(veg,1,sum)
spc.rich &lt;- spc.rich[-109] 
rich&lt;-data.frame(spc.rich)

east &lt;- na.omit(site$east)
north &lt;- na.omit(site$north)

rich &lt;- cbind(Row.Names = rownames(rich), rich)
site &lt;- cbind(Row.Names = rownames(site), site)
row.names(rich)&lt;-NULL
row.names(site)&lt;-NULL
# Merge these data together by the Row.Names
rs&lt;-merge(rich,site,by=c(&quot;Row.Names&quot;))

# Make points a matrix for coordinates by referencing the 8th column &quot;east&quot; and the 11th column &quot;north&quot;.
names(rs)
rsp &lt;- as.matrix(rs[c(8,11)])

# Make spatial points dataframe and a grid to interpolate over. This code makes the cellsize (resolution) 100 x 100; change to different cell values (e.g., 30,30 or 200, 200) to see how this changes the grid resolution.
rs1&lt;-SpatialPointsDataFrame(rsp,rs) 
rs_grid = spsample(rs1, type = &quot;regular&quot;, cellsize = c(500,500))
gridded(rs_grid) = TRUE
# Assign coordinates to the data
coordinates(rs)&lt;- ~east+north

# Visualize the grid cell size relative to the point locations. Adjust the cell size if needed - you may want to make the grid cell size finer (e.g., cellsize=c(50,50)) to capture the heterogeneity better.
plot(geometry(rs_grid))
plot(rs, add=TRUE, col=&quot;blue&quot;)</code></pre>
<p><img src="lab6_interp_connect_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>The code above leaves off at the <code>gstat</code> vignette <em>3 Spatial data frames</em>. Complete the <code>gstat</code> vignette with the data you chose to use. Consider the questions below.</p>
<div id="gstat-question-1" class="section level3">
<h3><code>gstat</code>: QUESTION 1</h3>
<p>How does the choice of the variogram models you chose (e.g., “Exp”, “Sph”, “Gau”, “Mat”), affect the interpolation outcome? Make 2 interpolation plots, one from each model and explain why they differ. If they are similar, why are they are similar?</p>
</div>
<div id="gstat-question-2" class="section level3">
<h3><code>gstat</code>: QUESTION 2</h3>
<p>How does grid resolution alter your interpolation? Compare 2 or more grid sizes by adjusting the cellsize() option. What resolution is most appropriate, given your data?</p>
</div>
<div id="gstat-question-3" class="section level3">
<h3><code>gstat</code>: QUESTION 3</h3>
<p>What could be causing the interpolated pattern in the variable that you are observing? What are some potential explanatory variables that influence the interpolated response variable? Are there some prior studies that provide evidence of some explanatory variables?</p>
<p><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Licensed under CC-BY 4.0 2020 by Phoebe Zarnetske</a>.</p>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
